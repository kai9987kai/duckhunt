######################################################
#                   DuckHunter                       #
#                 Pedro M. Sosa                      #
# Tool to prevent getting attacked by a rubberducky! #
######################################################

# Read User Instructions First!

### USER CONFIGURABLE SETTINGS ###
# ----------------------------------------------------
# Protection Policy Options:
#   "paranoid"  - Lock keyboard input until the correct password is entered.
#   "normal"    - Temporarily disable keyboard input when an attack is detected.
#   "sneaky"    - Drop selected keystrokes to disrupt potential attacks.
#   "logonly"   - Only log suspicious activity without blocking input.
policy = "normal"  

# Password for Paranoid Mode (lowercase only).
# (Only used when policy is set to "paranoid")
password = "quack"  

# Blacklisted Programs:
# Specify a comma-separated list of window name substrings.
# If any of these programs are active, the protection mechanism will trigger.
blacklist = "Command Prompt, Windows PowerShell"  

# Whitelisted Programs:
# Comma-separated window name substrings that should bypass all detection checks.
# Useful for trusted automation tools and repetitive workflows.
whitelist = ""  


### ADVANCED CONFIGURATION ###
# ----------------------------------------------------
# The following parameters typically do not need modification unless
# you are experiencing specific issues.

# Speed Threshold (in milliseconds):
# The maximum allowed interval between keystrokes. Values faster than this are considered suspicious.
threshold = 30  

# History Array Size:
# The number of recent keystroke intervals to average for determining typing speed.
size = 25  

# Sneaky Mode Key Drop Interval:
# In Sneaky mode, every nth keystroke will be dropped.
# (Default: Drop every 6th keystroke)
randdrop = 6  

# Log Filename:
# The file where attack events and suspicious keystrokes will be recorded.
filename = "log.txt"  

# Auto-Type Software Allowance:
# Set to True to allow keystrokes injected by trusted auto-type software (e.g., KeyPass, LastPass).
allow_auto_type_software = True  


### OPTIONAL ENHANCEMENTS ###
# ----------------------------------------------------
# Logging Level:
# Set the desired logging level ("DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL").
log_level = "INFO"  

# Debug Output:
# Enable additional console output for troubleshooting.
debug = False  

# --------------------------
# ADVANCED PROTECTION TUNING
# --------------------------
# Normal Policy Lockout Duration (milliseconds):
# After an intrusion is detected in "normal" mode, block input for this long.
normal_lockout_ms = 1200

# Rapid Burst Detection:
# If keystroke intervals are <= rapid_burst_interval_ms for rapid_burst_count
# consecutive events, classify as suspicious and trigger policy action.
rapid_burst_interval_ms = 12
rapid_burst_count = 8

# Injected Key Burst Detection:
# 0 disables this check.
# If >0, an injected-event streak of this length triggers policy action
# (even when auto-type software is allowed).
injected_burst_count = 0

# Signature Pattern Detection:
# Semicolon-separated suspicious key patterns.
# Each pattern is comma-separated key names using pyHook/pyWinhook style.
# Example:
# pattern_signatures = "LWIN,R,C,M,D,RETURN;LWIN,R,POWERSHELL,RETURN"
pattern_signatures = ""

# Pattern lookback depth for matching signatures.
key_buffer_size = 18

# Per-Window Threshold Overrides:
# Format: "window substring:threshold;other substring:threshold"
# Example: window_threshold_overrides = "powershell:22;command prompt:20"
window_threshold_overrides = ""

# Adaptive Threshold:
# Disabled by default. If enabled, DuckHunter learns your normal typing intervals
# and computes a blended effective threshold to reduce false positives while still
# being aggressive on likely injection bursts.
adaptive_threshold_enabled = False
adaptive_min_samples = 40
adaptive_sample_size = 140
adaptive_multiplier = 0.35
adaptive_floor_ms = 12
adaptive_ceiling_ms = 90

# Low-Variance Burst Detection:
# Detect machine-like typing where intervals are both fast and unnaturally stable.
low_variance_detection = True
low_variance_stddev_ms = 2.5
low_variance_speed_ceiling_ms = 55
low_variance_streak_count = 6

# Runtime Status Export:
# Optional JSON file for live status counters and detection telemetry.
# Leave empty to disable.
status_filename = ""
status_flush_interval = 250

# UI pause button duration (milliseconds).
pause_duration_ms = 30000

# Log Rotation:
# Prevent log file growth by rotating once the file reaches max bytes.
# Set log_max_bytes = 0 to disable rotation and use a single file.
log_max_bytes = 1048576
log_backup_count = 5

# Warmup Calibration:
# During startup warmup, speed-based detections can be logged without blocking.
# warmup_action options:
#   "logonly" -> log speed/burst detections but allow keypresses
#   "enforce" -> normal behavior from first event
warmup_events = 0
warmup_action = "logonly"

# End of configuration.
